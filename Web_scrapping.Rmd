---
title: "Web_scrapping"
author: "Miaobing"
date: "2024-08-12"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
library(rvest)
library(tidyselect)
library(xml2)
library(tidyverse)
library(purrr)
library(readr)
library(lubridate)
library(dplyr)
library(kableExtra)
```

```{r}
# Define link and page
link <- "http://books.toscrape.com/"
page <- read_html(link)
# call page to see the HTML structure.
```

```{r}
# Extract the titles from the h3 elements and convert to text
titles <- page %>%
html_elements("h3") %>% html_text2()
# View the extracted titles
```

```{r}
# Extract the prices from the elements with class "price_color"
book_price <- page %>%
  html_elements(".price_color") %>%
  html_text2() # This should also return a character vector

# Convert titles and prices to tibbles
title_tibble <- tibble(titles)
price_tibble <- tibble(book_price)

# Combine the title and price tibbles into a single data frame
book_df <- bind_cols(title_tibble, price_tibble)

# View the resulting data frame
print(book_df)
```
```{r}
# Define link and page
link <- "https://www.trustpilot.com/review/ubereats.com"
page <- read_html(link)
# call page to see the HTML structure.
print(page)
```
```{r}
# Clean and convert date strings into Date objects
clean_dates <- function(dates) {
  cleaned_dates <- gsub("Date of experience: ", "", dates)
  parsed_dates <- as.Date(cleaned_dates, format = "%B %d, %Y")
  parsed_dates <- parsed_dates[!is.na(parsed_dates)]
  return(parsed_dates)}
```

# Reviewer
```{r echo=FALSE,warning=FALSE}
# Extract the names of all reviewers
reviewers <- page %>%
  html_elements(".styles_cardWrapper__LcCPA") %>%
  html_elements(".typography_heading-xxs__QKBS8") %>%
  html_text(trim = TRUE)

# Convert extracted reviewer names into a tibble format
reviewers_tf <- tibble(reviewer = reviewers)
# Display the first 6 rows of the reviewer names
reviewers_tf %>%
  head(6) %>%
  kable(col.names = "Reviewer") %>%
  kable_styling(bootstrap_options = c("striped", "responsive"),
                full_width = FALSE, position = "left")
```

# Rating




